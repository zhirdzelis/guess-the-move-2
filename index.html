<!DOCTYPE html>
<html lang="lv">
<head>
<meta charset="UTF-8">
<title>Šahs vs Stockfish (teksta demo)</title>
<style>
body { font-family: sans-serif; padding: 20px; }
#log { border: 1px solid #ccc; padding: 10px; height: 300px; overflow-y: scroll; background: #f9f9f9; }
input { padding: 5px; font-size: 1em; width: 80px; }
button { padding: 5px; font-size: 1em; }
</style>
</head>
<body>

<h2>Šahs vs Stockfish (teksta demo)</h2>

<div id="log">Spēle sākas...</div>
<input type="text" id="move" placeholder="e2e4">
<button onclick="makeMove()">Gājiens</button>

<script>
const engine = new Worker("stockfish.js");
let engineReady = false;
let currentFEN = "startpos";

engine.onmessage = function(e) {
    const line = e.data;

    if (line === "uciok") { engine.postMessage("isready"); return; }
    if (line === "readyok") { engineReady = true; log("Stockfish gatavs!"); return; }

    if (line.startsWith("bestmove")) {
        const move = line.split(" ")[1];
        log("Stockfish: " + move);
        currentFEN = updateFEN(move, currentFEN); // tikai simboliski, FEN atjaunošana nav obligāta
    }
};

// Sāk Stockfish
engine.postMessage("uci");

function log(msg) {
    const logDiv = document.getElementById("log");
    logDiv.innerHTML += "<div>> " + msg + "</div>";
    logDiv.scrollTop = logDiv.scrollHeight;
}

function makeMove() {
    const input = document.getElementById("move");
    const move = input.value.trim();
    if (!move) return;

    log("Tu: " + move);
    input.value = "";

    if (engineReady) {
        engine.postMessage("position startpos moves " + move);
        engine.postMessage("go depth 10");
    }
}

// Vienkārša vietas turēšana FEN atjaunošanai (var ignorēt vizuāli)
function updateFEN(move, fen) {
    return fen + " " + move;
}
</script>

</body>
</html>
